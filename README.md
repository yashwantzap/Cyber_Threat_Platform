# Cybersecurity Threat Analysis and Mitigation System

## Overview
This project provides a full pipeline for cybersecurity threat analysis. It collects vulnerability data, trains a machine learning model to predict risk levels, and generates mitigation plans using AI. It includes a Flask API backend and a web dashboard frontend for interactive use.

## Features
- Collects latest known exploited vulnerabilities from CISA feed.
- Trains a Random Forest model to classify threat risk levels (Low, Medium, High).
- Generates human-readable mitigation plans with Google Gemini generative AI.
- Interactive mode for custom vulnerability analysis.
- REST API server to trigger data collection, training, and analysis.
- Web dashboard visualizing vulnerabilities and mitigation workflows.

## File Descriptions

| File                 | Description                                                  |
|----------------------|--------------------------------------------------------------|
| `data_collector.py`  | Collects and saves vulnerability data from CISA KEV feed.  |
| `threat_predictor.py` | Preprocesses data, trains and saves threat prediction model.|
| `threat_mitigation.py`| Loads model, analyzes vulnerabilities, generates mitigation plans.|
| `server.py`          | Flask API backend exposing endpoints for data and analysis.  |
| `index.html`         | Web dashboard frontend for visualization and user input.     |
| `requirements.txt`   | Python dependencies required for the project.                 |

## Installation

1. Clone the repository.
2. Install required packages:
   
   ```
   pip install -r requirements.txt
   ```
3. Set your Google Gemini API key as environment variable:

   ```
   export GEMINIAPIKEY=your-api-key
   ```
   Or create a `.env` file with:

   ```
   GEMINIAPIKEY=your-api-key
   ```

## Usage

### Collect Vulnerability Data

```
python data_collector.py
```

### Train Threat Prediction Model

```
python threat_predictor.py
```

### Analyze Vulnerabilities and Generate Mitigation Plans

```
python threat_mitigation.py
```

### Run the API Server

Start Flask server for API endpoints:

```
python server.py
```

Access at `http://localhost:5000`.

### Web Dashboard

Open `index.html` in a browser to use the interactive dashboard for analyzing vulnerabilities and viewing mitigation plans.

## API Endpoints

- `POST /api/collectdata` - Trigger new data collection.
- `POST /api/trainmodel` - Trigger model training.
- `POST /api/analyzevulnerability` - Analyze a vulnerability by passing a JSON payload with the `cveID`.

## Environment Variables

- `GEMINIAPIKEY`: API key for Google Gemini generative AI used to create mitigation plans.

## Notes

- The model file `threatmodel.pkl` must be generated by training before analysis.
- Fallback mitigation plan is used if generative AI fails.
- Frontend uses CORS to communicate with backend API.

## Dependencies

Key dependencies listed in `requirements.txt`:

- pandas
- scikit-learn
- imbalanced-learn
- joblib
- google-generativeai
- requests
- Flask
- Flask-CORS

